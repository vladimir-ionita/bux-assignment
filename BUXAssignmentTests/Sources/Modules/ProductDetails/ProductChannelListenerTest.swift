//
//  ProductChannelListenerTest.swift
//  BUXAssignmentTests
//
//  Created by Vladimir Ionița on 16/11/2017.
//  Copyright © 2017 Vladimir Ionița. All rights reserved.
//

@testable import BUXAssignment
import XCTest

class ProductChannelListenerTest: XCTestCase {
//    func testThatChannelListenerConnectsToWebSocket() {
//        let request = URLRequest(url: URL(string: "http://localhost:8080/subscriptions/me")!)
//        let mockWebSocket = MockWebSocket(request: request)
//        let channelLister = ProductChannelListener(webSocket: mockWebSocket)
//        channelLister.subscribeToChannel(productIdentifier: Stubs.productStub().identifier)
//        
//        XCTAssertTrue(mockWebSocket.connectMethodCalled)
//    }
//    
//    func testThatChannelListenerSubscribesForProductUpdates() {
//        let mockWebSocket = MockWebSocket(url: URL(string: "http://localhost:8080/subscriptions/me")!)
//        let channelLister = ProductChannelListener(webSocket: mockWebSocket)
//        channelLister.subscribeToChannel(productIdentifier: Stubs.productStub().identifier)
//        
//        guard
//            let data = mockWebSocket.lastWrittenData,
//            let jsonObject = try? JSONSerialization.jsonObject(with: data, options: []),
//            let jsonDictionary = jsonObject as? JSONDictionary else
//        {
//            XCTFail()
//            return
//        }
//        
//        XCTAssertNotNil(jsonDictionary["subscribeTo"])
//    }
}
